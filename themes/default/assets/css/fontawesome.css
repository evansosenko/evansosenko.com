{{ $production := eq (getenv "HUGO_ENV") "production" | or (eq site.Params.env "production") }}

.fa {
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
  background-color: var(--color);
}

.toggle-theme .fa {
  mask-image: var(--toggle-theme-icon);
  -webkit-mask-image: var(--toggle-theme-icon);
}

{{ range resources.Match "img/fa/*.svg" }}
.fa-{{ path.BaseName . }} {
  {{ $asset := . }}
  {{ $asset = resources.Fingerprint . }}
  {{ if $production }}
    {{ $asset = resources.Fingerprint $asset }}
  {{ end }}
  mask-image: url('{{ $asset.RelPermalink }}');
  -webkit-mask-image: url('{{ $asset.RelPermalink }}');
}
{{ end }}

{{ $darkIcon := "img/fa/moon-stars-duotone.svg" }}
{{ $darkIcon = resources.Get $darkIcon }}
{{ if $production }}
  {{ $darkIcon = resources.Fingerprint $darkIcon }}
{{ end }}

{{ $lightIcon := "img/fa/sparkles-duotone.svg" }}
{{ $lightIcon = resources.Get $lightIcon }}
{{ if $production }}
  {{ $lightIcon = resources.Fingerprint $lightIcon }}
{{ end }}

[data-theme='light'],
:root:not([data-theme='dark']) {
  --toggle-theme-icon: url('{{ $lightIcon.RelPermalink }}');
}

@media only screen and (prefers-color-scheme: dark) {
  :root:not([data-theme='light']) {
    --toggle-theme-icon: url('{{ $darkIcon.RelPermalink }}');
  }
}

[data-theme='dark'] {
  --toggle-theme-icon: url('{{ $darkIcon.RelPermalink }}');
}
