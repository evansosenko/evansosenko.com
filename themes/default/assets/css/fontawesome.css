{{ $production := eq (getenv "HUGO_ENV") "production" | or (eq site.Params.env "production") }}

.fa {
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
  background-color: var(--color);
}

{{ range resources.Match "img/fa/*.svg" }}
.fa-{{ path.BaseName . }} {
  {{ $asset := . }}
  {{ $asset = resources.Fingerprint . }}
  {{ if $production }}
    {{ $asset = resources.Fingerprint $asset }}
  {{ end }}
  mask-image: url('{{ $asset.RelPermalink }}');
  -webkit-mask-image: url('{{ $asset.RelPermalink }}');
}
{{ end }}

{{ $darkIcon := "img/fa/moon-stars-duotone.svg" }}
{{ $darkIcon = resources.Get $darkIcon }}
{{ if $production }}
  {{ $darkIcon = resources.Fingerprint $darkIcon }}
{{ end }}

{{ $lightIcon := "img/fa/eclipse-duotone.svg" }}
{{ $lightIcon = resources.Get $lightIcon }}
{{ if $production }}
  {{ $lightIcon = resources.Fingerprint $lightIcon }}
{{ end }}

[data-theme='light'] .fa-_theme {
  mask-image: url('{{ $lightIcon.RelPermalink }}');
  -webkit-mask-image: url('{{ $lightIcon.RelPermalink }}');
}

[data-theme='dark'] .fa-_theme {
  mask-image: url('{{ $darkIcon.RelPermalink }}');
  -webkit-mask-image: url('{{ $darkIcon.RelPermalink }}');
}

@media only screen and (prefers-color-scheme: dark) {
  not([data-theme='light']) .fa-_theme {
    mask-image: url('{{ $darkIcon.RelPermalink }}');
    -webkit-mask-image: url('{{ $darkIcon.RelPermalink }}');
  }
}

@media only screen and (prefers-color-scheme: light) {
  not([data-theme='dark']) .fa-_theme {
    mask-image: url('{{ $lightIcon.RelPermalink }}');
    -webkit-mask-image: url('{{ $lightIcon.RelPermalink }}');
  }
}

