{{ $production := not site.IsServer }}

{{ $asset := resources.Get . | resources.ExecuteAsTemplate (path.Base .) . }}
{{ if $production }}
  {{ $asset = resources.Fingerprint $asset }}
{{ end }}

{{ if strings.HasSuffix $asset.RelPermalink ".css" }}
  <link rel="stylesheet"
    {{ if $production }}integrity="{{ $asset.Data.Integrity }}"{{ end }}
    href="{{ $asset.RelPermalink }}">
{{ end }}

{{ if strings.HasSuffix $asset.RelPermalink ".js" }}
  <script
    type="module"
    src="{{ $asset.RelPermalink }}"
    {{ if $production }}integrity="{{ $asset.Data.Integrity }}"{{ end }}
    crossorigin="anonymous">
  </script>
{{ end }}
